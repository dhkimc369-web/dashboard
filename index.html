<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì œì¡°íŒ€ ì—…ë¬´ ê²Œì‹œíŒ (ë””ìì¸ ë™ê¸°í™”í˜•)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f1f5f9; height: 100vh; display: flex; flex-direction: column; overflow: hidden; font-family: 'Pretendard', sans-serif; }
        .main-container { display: flex; flex: 1; gap: 15px; padding: 15px; width: 100%; box-sizing: border-box; }
        .column { display: flex; flex-direction: column; gap: 15px; }
        .card { background: white; border-radius: 12px; border: 1px solid #e2e8f0; padding: 15px; display: flex; flex-direction: column; box-shadow: 0 4px 6px rgba(0,0,0,0.05); overflow: hidden; }
        .card-title { font-size: 1.3rem; font-weight: 800; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px; margin-bottom: 10px; }
        
        .scroll-box { flex: 1; overflow-y: auto; position: relative; background-color: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; scrollbar-width: thin; }
        .scroll-box::-webkit-scrollbar { width: 4px; }
        .scroll-box::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 10px; }

        /* innerHTMLì„ ì‚¬ìš©í•˜ë¯€ë¡œ pre-wrap ëŒ€ì‹  br íƒœê·¸ ëŒ€ì‘ */
        .scroll-content { padding: 12px; font-size: 1.1rem; line-height: 1.6; color: #1e293b; position: relative; word-break: break-all; }
        .animate-scroll { animation: scrollLoop 30s linear infinite alternate; }
        .scroll-box:hover .animate-scroll { animation-play-state: paused; }
        @keyframes scrollLoop { 0% { transform: translateY(0); } 100% { transform: translateY(calc(-100% + 150px)); } }

        .ot-box { display: flex; flex-direction: column; align-items: center; background: #334155; padding: 5px; border-radius: 8px; width: 95px; position: relative; }
        .ot-input { width: 100%; height: 40px; background: white; color: black; font-size: 1.8rem; font-weight: 900; text-align: center; border: 2px solid #fbbf24; border-radius: 6px; outline: none; }
        .max-highlight { transform: scale(1.1); background: #7c3aed !important; box-shadow: 0 0 20px #fbbf24; }
        .max-highlight::after { content: 'ğŸ‰'; position: absolute; top: -15px; font-size: 1.5rem; animation: firework 0.8s infinite alternate; }
        
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .marquee-container { flex: 1; margin: 0 40px; overflow: hidden; white-space: nowrap; }
        .marquee-text { display: inline-block; font-size: 1.6rem; font-weight: 700; color: #fbbf24; animation: marquee 15s linear infinite; }
    </style>
</head>
<body>

    <header class="flex justify-between items-center bg-[#1e293b] text-white p-5 shadow-xl">
        <div style="min-width: 380px;">
            <h1 class="text-3xl font-black text-[#fbbf24]">ì œì¡°íŒ€ ì—…ë¬´ ê²Œì‹œíŒ</h1>
            <div id="clockDisplay" class="text-xl font-bold text-slate-300 mt-1">ë¡œë”© ì¤‘...</div>
        </div>
        <div class="marquee-container">
            <div id="scrollingNotice" class="marquee-text">í˜„ì¥ ë°ì´í„° ë™ê¸°í™” ì¤‘...</div>
        </div>
        <div class="flex items-center gap-4">
            <div class="flex gap-3 bg-[#0f172a] p-3 rounded-lg border border-slate-700 items-center">
                <span class="text-sm font-black text-[#fbbf24] mr-2">ğŸŒ™ ì—°ì¥ ì¸ì›</span>
                <div id="box-otBBT" class="ot-box"><span class="text-[11px] text-white mb-1 font-bold">BBT</span><input type="text" id="otBBT" class="ot-input" readonly></div>
                <div id="box-otInsert" class="ot-box"><span class="text-[11px] text-white mb-1 font-bold">ì¸ì„œíŠ¸</span><input type="text" id="otInsert" class="ot-input" readonly></div>
                <div id="box-otRetouch" class="ot-box"><span class="text-[11px] text-white mb-1 font-bold">ë¦¬í„°ì¹˜</span><input type="text" id="otRetouch" class="ot-input" readonly></div>
            </div>
        </div>
    </header>

    <div class="main-container flex-col">
        <div class="flex flex-1 gap-4" style="height: 65%;">
            <div class="column w-1/3">
                <div class="card h-1/2"><h2 class="card-title text-red-500">ğŸ“¢ ê³µì§€ ì‚¬í•­</h2><div class="scroll-box"><div id="notice" class="scroll-content"></div></div></div>
                <div class="card h-1/2"><h2 class="card-title text-blue-500">ğŸ‘¥ ê·¼íƒœ í˜„í™©</h2><div class="scroll-box"><div id="attendance" class="scroll-content"></div></div></div>
            </div>
            <div class="column w-1/3">
                <div class="card h-full border-t-[6px] border-blue-500"><h2 class="card-title text-blue-600 italic">âœ… ì—…ë¬´ ê³µìœ </h2><div class="scroll-box" style="background-color: #eff6ff;"><div id="todoSheet" class="scroll-content"></div></div></div>
            </div>
            <div class="column w-1/3">
                <div class="card h-1/2"><h2 class="card-title text-green-500">ğŸ“¦ ë‚©í’ˆ ëª©ë¡</h2><div class="scroll-box"><div id="delivery" class="scroll-content"></div></div></div>
                <div class="card h-1/2 border-t-[6px] border-teal-500"><h2 class="card-title text-teal-600">ğŸ“Š ì§„í–‰ í˜„í™© ëª©ë¡</h2><div class="scroll-box" style="background-color: #f0fdfa;"><div id="statusList" class="scroll-content"></div></div></div>
            </div>
        </div>
        <div class="flex gap-4" style="height: 35%;">
            <div class="card w-1/3"><h2 class="card-title text-purple-600">ğŸ“Š BBT</h2><div class="scroll-box"><div id="shareBBT" class="scroll-content"></div></div></div>
            <div class="card w-1/3"><h2 class="card-title text-orange-600">ğŸ”§ ì¸ì„œíŠ¸</h2><div class="scroll-box"><div id="shareInsert" class="scroll-content"></div></div></div>
            <div class="card w-1/3"><h2 class="card-title text-teal-600">âš ï¸ ë¦¬í„°ì¹˜</h2><div class="scroll-box"><div id="shareRetouch" class="scroll-content"></div></div></div>
        </div>
    </div>

    <script>
        // ì¤‘ìš”: ì—¬ê¸°ì— ë³¸ì¸ì˜ ì›¹ ì•± URLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!
        const API_URL = 'https://script.google.com/macros/s/AKfycbxglf0RNj9xU7EHRc_Ir58CBBPQcBxOSWTX_yMaKiDf05KxRq2UreijmGFk-S4GIl2_uw/exec';

        async function loadData() {
            try {
                const res = await fetch(API_URL);
                const data = await res.json(); // [1í–‰ë‚´ìš©, 2í–‰ë‚´ìš©, ...] í˜•íƒœì˜ ë°°ì—´

                // ë””ìì¸ ì •ë³´ê°€ í¬í•¨ëœ HTML ê·¸ëŒ€ë¡œ ì‚½ì…
                const updateField = (id, html) => {
                    const el = document.getElementById(id);
                    el.innerHTML = html;
                    el.classList.toggle('animate-scroll', el.scrollHeight > el.parentElement.clientHeight);
                };

                // ì—°ì¥ ì¸ì› (ìˆ«ìë§Œ ì¶”ì¶œí•˜ì—¬ ì—…ë°ì´íŠ¸)
                const v1 = data[0].replace(/<[^>]*>/g, '') || 0;
                const v2 = data[1].replace(/<[^>]*>/g, '') || 0;
                const v3 = data[2].replace(/<[^>]*>/g, '') || 0;
                document.getElementById('otBBT').value = v1;
                document.getElementById('otInsert').value = v2;
                document.getElementById('otRetouch').value = v3;

                // ê°•ì¡° íš¨ê³¼
                const nums = [parseInt(v1)||0, parseInt(v2)||0, parseInt(v3)||0];
                const max = Math.max(...nums);
                ['box-otBBT', 'box-otInsert', 'box-otRetouch'].forEach((id, i) => {
                    document.getElementById(id).classList.toggle('max-highlight', nums[i] === max && max > 0);
                });

                // ê° êµ¬ì—­ ì—…ë°ì´íŠ¸
                document.getElementById('scrollingNotice').innerHTML = data[3].replace(/<br>/g, " | ");
                updateField('notice', data[4]);
                updateField('attendance', data[5]);
                updateField('delivery', data[6]);
                updateField('todoSheet', data[7]);
                updateField('statusList', data[8]);
                updateField('shareBBT', data[9]);
                updateField('shareInsert', data[10]);
                updateField('shareRetouch', data[11]);

            } catch (e) { console.error("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨", e); }
        }

        function init() {
            setInterval(() => {
                document.getElementById('clockDisplay').innerText = new Date().toLocaleString('ko-KR');
            }, 1000);
            loadData();
            setInterval(loadData, 30000);
        }
        window.onload = init;
    </script>
</body>
</html>