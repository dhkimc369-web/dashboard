<script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbwN8VJRl7Ui3OJgI7r9Tj8b4SaTEZQmiCEyu7V_-cmHEbiXO65bUmjDpD4rR5kV2URcVg/exec';

    async function updateBoard() {
        try {
            const response = await fetch(API_URL);
            const data = await response.json();
            
            if (Array.isArray(data)) {
                // 1. 상단 인원수: HTML 태그를 제거하고 숫자만 추출하여 UI 유지
                const cleanNum = (html) => html.replace(/<[^>]*>?/gm, '').replace(/[^0-9]/g, '') || "0";
                document.getElementById('v1').innerText = cleanNum(data[0]);
                document.getElementById('v2').innerText = cleanNum(data[1]);
                document.getElementById('v3').innerText = cleanNum(data[2]);
                
                // 2. 전광판: 서식 포함하여 적용
                document.getElementById('scrollNotice').innerHTML = data[3] || "";
                
                // 3. 하단 카드: 빨간색 등 시트 서식 완벽 복구
                for(let i=0; i<8; i++) {
                    const target = document.getElementById('r' + (i+5));
                    if(target) {
                        target.innerHTML = data[i+4] || ""; 
                    }
                }
            }
        } catch (error) { console.warn("데이터 갱신 중..."); }
    }

    // 확대창 함수: 내부 HTML(서식)을 그대로 복사하도록 유지
    function openZ(el) {
        const h = el.querySelector('.card-h');
        const b = el.querySelector('.card-b');
        document.getElementById('zHead').innerText = h.innerText;
        document.getElementById('zHead').style.backgroundColor = getComputedStyle(h).backgroundColor;
        document.getElementById('zBody').innerHTML = b.innerHTML; // 서식 유지 핵심
        document.getElementById('zoom').style.display = 'flex';
    }

    updateBoard();
    setInterval(updateBoard, 15000); // 15초마다 체크
</script>
