<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì œì¡°íŒ€ ì—…ë¬´ ê²Œì‹œíŒ (ê°•ì¡° íš¨ê³¼í˜•)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f1f5f9; height: 100vh; display: flex; flex-direction: column; overflow: hidden; font-family: 'Pretendard', sans-serif; }
        .main-container { display: flex; flex: 1; gap: 15px; padding: 15px; width: 100%; box-sizing: border-box; }
        .column { display: flex; flex-direction: column; gap: 15px; }
        .card { background: white; border-radius: 12px; border: 1px solid #e2e8f0; padding: 15px; display: flex; flex-direction: column; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .card-title { font-size: 1.3rem; font-weight: 800; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px; margin-bottom: 10px; }
        textarea { width: 100% !important; flex: 1; padding: 10px; background-color: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 1.15rem; resize: none; overflow-y: auto; line-height: 1.6; color: #1e293b; font-weight: 500; outline: none; }
        
        .ot-box { display: flex; flex-direction: column; align-items: center; background: #334155; padding: 5px; border-radius: 8px; width: 95px; position: relative; transition: all 0.5s; }
        .ot-input { width: 100%; height: 40px; background: white; color: black; font-size: 1.8rem; font-weight: 900; text-align: center; border: 2px solid #fbbf24; border-radius: 6px; outline: none; }

        /* í­ì£½ ë° ê°•ì¡° ì• ë‹ˆë©”ì´ì…˜ */
        .max-highlight { transform: scale(1.1); background: #7c3aed !important; border: 2px solid #fbbf24; z-index: 10; box-shadow: 0 0 20px #fbbf24; }
        .max-highlight::after { content: 'ğŸ‰'; position: absolute; top: -15px; font-size: 1.5rem; animation: firework 0.8s infinite alternate; }
        @keyframes firework { 0% { transform: translateY(0); } 100% { transform: translateY(-10px); } }

        /* ì „ê´‘íŒ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .marquee-container { flex: 1; margin: 0 40px; overflow: hidden; white-space: nowrap; }
        .marquee-text { display: inline-block; font-size: 1.6rem; font-weight: 700; color: #fbbf24; animation: marquee 15s linear infinite; }
    </style>
</head>
<body>

    <header class="flex justify-between items-center bg-[#1e293b] text-white p-5 shadow-xl">
        <div style="min-width: 380px;">
            <h1 class="text-3xl font-black text-[#fbbf24]">ì œì¡°íŒ€ ì—…ë¬´ ê²Œì‹œíŒ</h1>
            <div id="clockDisplay" class="text-xl font-bold text-slate-300 mt-1">ë¡œë”© ì¤‘...</div>
        </div>

        <div class="marquee-container">
            <div id="scrollingNotice" class="marquee-text">í˜„ì¥ ë°ì´í„° ë™ê¸°í™” ì¤‘...</div>
        </div>

        <div class="flex items-center gap-4">
            <div class="flex gap-3 bg-[#0f172a] p-3 rounded-lg border border-slate-700 items-center">
                <span class="text-sm font-black text-[#fbbf24] mr-2">ğŸŒ™ ì—°ì¥ ì¸ì›</span>
                <div id="box-otBBT" class="ot-box"><span class="text-[11px] text-white mb-1 font-bold">BBT</span><input type="text" id="otBBT" class="ot-input" readonly></div>
                <div id="box-otInsert" class="ot-box"><span class="text-[11px] text-white mb-1 font-bold">ì¸ì„œíŠ¸</span><input type="text" id="otInsert" class="ot-input" readonly></div>
                <div id="box-otRetouch" class="ot-box"><span class="text-[11px] text-white mb-1 font-bold">ë¦¬í„°ì¹˜</span><input type="text" id="otRetouch" class="ot-input" readonly></div>
            </div>
        </div>
    </header>

    <div class="main-container flex-col">
        <div class="flex flex-1 gap-4" style="height: 65%;">
            <div class="column w-1/3">
                <div class="card h-1/2"><h2 class="card-title text-red-500">ğŸ“¢ ê³µì§€ ì‚¬í•­</h2><textarea id="notice" readonly></textarea></div>
                <div class="card h-1/2"><h2 class="card-title text-blue-500">ğŸ‘¥ ê·¼íƒœ í˜„í™©</h2><textarea id="attendance" readonly></textarea></div>
            </div>
            <div class="column w-1/3">
                <div class="card h-full border-top" style="border-top: 6px solid #3b82f6;"><h2 class="card-title text-blue-600 italic">âœ… ì—…ë¬´ ê³µìœ </h2><textarea id="todoSheet" class="bg-blue-50/50" readonly></textarea></div>
            </div>
            <div class="column w-1/3">
                <div class="card h-1/2"><h2 class="card-title text-green-500">ğŸ“¦ ê¸ˆì¼ ë‚©í’ˆ ëª©ë¡</h2><textarea id="delivery" readonly></textarea></div>
                <div class="card h-1/2 border-top" style="border-top: 6px solid #ef4444;"><h2 class="card-title text-red-600">ğŸš¨ ê¸´ê¸‰ ì§„í–‰ ê±´</h2><textarea id="urgent" class="bg-red-50" readonly></textarea></div>
            </div>
        </div>

        <div class="flex gap-4" style="height: 35%;">
            <div class="card w-1/3"><h2 class="card-title text-purple-600">ğŸ“Š BBT</h2><textarea id="shareBBT" readonly></textarea></div>
            <div class="card w-1/3"><h2 class="card-title text-orange-600">ğŸ”§ ì¸ì„œíŠ¸</h2><textarea id="shareInsert" readonly></textarea></div>
            <div class="card w-1/3"><h2 class="card-title text-teal-600">âš ï¸ ë¦¬í„°ì¹˜</h2><textarea id="shareRetouch" readonly></textarea></div>
        </div>
    </div>

    <script>
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTmOR1Hvcso4G0weHKCXvPpy9enUYo2mX0NIECrY7TDbjDfR_hf1fEBBUBM0qY1Pd8pL1HFFfqex88Z/pub?output=csv';

        const clean = (str) => {
            if (!str) return "";
            return str.replace(/^"|"$/g, '').trim().split('//').join('\n');
        };

        async function loadData() {
            try {
                const res = await fetch(`${SHEET_URL}&t=${Date.now()}`);
                const text = await res.text();
                const rows = text.split('\r\n');
                if (rows.length < 2) return;
                const data = rows[1].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);

                // ì—°ì¥ ì¸ì› ë° ì• ë‹ˆë©”ì´ì…˜
                const bbt = parseInt(clean(data[0])) || 0;
                const ins = parseInt(clean(data[1])) || 0;
                const ret = parseInt(clean(data[2])) || 0;
                
                document.getElementById('otBBT').value = bbt;
                document.getElementById('otInsert').value = ins;
                document.getElementById('otRetouch').value = ret;

                // ìµœëŒ€ê°’ ì°¾ê¸° ë° ê°•ì¡°
                const boxes = [
                    {val: bbt, id: 'box-otBBT'},
                    {val: ins, id: 'box-otInsert'},
                    {val: ret, id: 'box-otRetouch'}
                ];
                const maxVal = Math.max(bbt, ins, ret);
                boxes.forEach(box => {
                    const el = document.getElementById(box.id);
                    el.classList.remove('max-highlight');
                    if (box.val === maxVal && maxVal > 0) el.classList.add('max-highlight');
                });

                document.getElementById('scrollingNotice').innerText = clean(data[3]).replace(/\n/g, " | ");
                document.getElementById('notice').value = clean(data[4]);
                document.getElementById('attendance').value = clean(data[5]);
                document.getElementById('delivery').value = clean(data[6]);
                document.getElementById('todoSheet').value = clean(data[7]);
                document.getElementById('urgent').value = clean(data[8]);
                document.getElementById('shareBBT').value = clean(data[9]);
                document.getElementById('shareInsert').value = clean(data[10]);
                document.getElementById('shareRetouch').value = clean(data[11]);
            } catch (e) { console.error("ë°ì´í„° ê°±ì‹  ì¤‘..."); }
        }

        function init() {
            setInterval(() => {
                const now = new Date();
                document.getElementById('clockDisplay').innerText = now.toLocaleString('ko-KR', { year: 'numeric', month: '2-digit', day: '2-digit', weekday: 'short', hour: '2-digit', minute: '2-digit', second: '2-digit' });
            }, 1000);
            loadData();
            setInterval(loadData, 30000);
        }
        window.onload = init;
    </script>
</body>
</html>n: column; align-items: center; background: #334155; padding: 5px; border-radius: 8px; width: