<script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbwaBtJ1lNH1ulq5mITvNzw-Fn2lRljsO4z7s_IqqZpLFgAgCpnpIFcz7cQ4_9FJD-EKvg/exec';

    async function updateBoard() {
        try {
            const response = await fetch(API_URL);
            const data = await response.json();
            
            if (Array.isArray(data)) {
                // 상단 인원수 (숫자만 추출)
                const toNum = (t) => t.replace(/[^0-9]/g, '') || "0";
                document.getElementById('v1').innerText = toNum(data[0]);
                document.getElementById('v2').innerText = toNum(data[1]);
                document.getElementById('v3').innerText = toNum(data[2]);
                
                // 전광판 및 카드 업데이트
                document.getElementById('scrollNotice').innerHTML = data[3];
                
                for(let i=0; i<8; i++) {
                    const target = document.getElementById('r' + (i+5));
                    if(target) {
                        let content = data[i+4] || "";
                        // [핵심] 시트에서 가져오는 대신 웹에서 중요 키워드에 색상을 입힙니다.
                        content = content.replace(/(불량|대기|공유|주의|연차|확인 완료|요청 완료|진행)/g, 
                            '<span style="color:#ef4444; font-weight:bold;">$1</span>');
                        target.innerHTML = content;
                    }
                }
            }
        } catch (e) { console.error("데이터 로딩 중..."); }
    }
    
    // 확대창 기능 유지
    function openZ(el) {
        const h = el.querySelector('.card-h');
        const b = el.querySelector('.card-b');
        document.getElementById('zHead').innerText = h.innerText;
        document.getElementById('zHead').style.backgroundColor = getComputedStyle(h).backgroundColor;
        document.getElementById('zBody').innerHTML = b.innerHTML; 
        document.getElementById('zoom').style.display = 'flex';
    }

    updateBoard();
    setInterval(updateBoard, 10000); // 10초마다 갱신
</script>
