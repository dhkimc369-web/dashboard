<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì œì¡°íŒ€ ì—…ë¬´ ê²Œì‹œíŒ (ì•ŒëŒ ë° ìë™ìŠ¤í¬ë¡¤ ì¶”ê°€)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f1f5f9; height: 100vh; display: flex; flex-direction: column; overflow: hidden; font-family: 'Pretendard', sans-serif; }
        .main-container { display: flex; flex: 1; gap: 15px; padding: 15px; width: 100%; box-sizing: border-box; }
        .column { display: flex; flex-direction: column; gap: 15px; }
        .card { background: white; border-radius: 12px; border: 1px solid #e2e8f0; padding: 15px; display: flex; flex-direction: column; box-shadow: 0 4px 6px rgba(0,0,0,0.05); overflow: hidden; }
        .card-title { font-size: 1.3rem; font-weight: 800; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px; margin-bottom: 10px; }
        
        /* í…ìŠ¤íŠ¸ ì˜ì—­ ìë™ ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */
        .scroll-box { flex: 1; overflow: hidden; position: relative; background-color: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; }
        .scroll-content { padding: 10px; font-size: 1.15rem; line-height: 1.6; color: #1e293b; font-weight: 500; white-space: pre-wrap; animation: scrollText 20s linear infinite; }
        .scroll-content:hover { animation-play-state: paused; } /* ë§ˆìš°ìŠ¤ ì˜¬ë¦¬ë©´ ì •ì§€ */

        @keyframes scrollText {
            0% { transform: translateY(0); }
            50% { transform: translateY(-30%); }
            100% { transform: translateY(0); }
        }

        /* ì „ê´‘íŒ ë° ì—°ì¥ì¸ì› íš¨ê³¼ */
        .ot-box { display: flex; flex-direction: column; align-items: center; background: #334155; padding: 5px; border-radius: 8px; width: 95px; position: relative; transition: all 0.5s; }
        .ot-input { width: 100%; height: 40px; background: white; color: black; font-size: 1.8rem; font-weight: 900; text-align: center; border: 2px solid #fbbf24; border-radius: 6px; outline: none; }
        .max-highlight { transform: scale(1.1); background: #7c3aed !important; box-shadow: 0 0 20px #fbbf24; }
        .max-highlight::after { content: 'ğŸ‰'; position: absolute; top: -15px; font-size: 1.5rem; animation: firework 0.8s infinite alternate; }
        @keyframes firework { 0% { transform: translateY(0); } 100% { transform: translateY(-10px); } }

        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .marquee-container { flex: 1; margin: 0 40px; overflow: hidden; white-space: nowrap; }
        .marquee-text { display: inline-block; font-size: 1.6rem; font-weight: 700; color: #fbbf24; animation: marquee 15s linear infinite; }

        /* íŒì—… ì•ŒëŒ ìŠ¤íƒ€ì¼ (12:58~13:03) */
        #alertBanner {
            display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 80%; background: rgba(239, 68, 68, 0.95); color: white; padding: 50px;
            border-radius: 20px; text-align: center; font-size: 5rem; font-weight: 900;
            z-index: 1000; box-shadow: 0 0 100px rgba(0,0,0,0.5); animation: blink 1s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 1; transform: translate(-50%, -50%) scale(1); } 50% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.05); } }
    </style>
</head>
<body>

    <div id="alertBanner">ğŸ“¦ ë‚©í’ˆ í’ˆëª© í™•ì¸!!</div>

    <header class="flex justify-between items-center bg-[#1e293b] text-white p-5 shadow-xl">
        <div style="min-width: 380px;">
            <h1 class="text-3xl font-black text-[#fbbf24]">ì œì¡°íŒ€ ì—…ë¬´ ê²Œì‹œíŒ</h1>
            <div id="clockDisplay" class="text-xl font-bold text-slate-300 mt-1">ì‹œê°„ ë¡œë”© ì¤‘...</div>
        </div>
        <div class="marquee-container">
            <div id="scrollingNotice" class="marquee-text">í˜„ì¥ ë°ì´í„° ë™ê¸°í™” ì¤‘...</div>
        </div>
        <div class="flex items-center gap-4">
            <div class="flex gap-3 bg-[#0f172a] p-3 rounded-lg border border-slate-700 items-center">
                <span class="text-sm font-black text-[#fbbf24] mr-2">ğŸŒ™ ì—°ì¥ ì¸ì›</span>
                <div id="box-otBBT" class="ot-box"><span class="text-[11px] text-white mb-1 font-bold">BBT</span><input type="text" id="otBBT" class="ot-input" readonly></div>
                <div id="box-otInsert" class="ot-box"><span class="text-[11px] text-white mb-1 font-bold">ì¸ì„œíŠ¸</span><input type="text" id="otInsert" class="ot-input" readonly></div>
                <div id="box-otRetouch" class="ot-box"><span class="text-[11px] text-white mb-1 font-bold">ë¦¬í„°ì¹˜</span><input type="text" id="otRetouch" class="ot-input" readonly></div>
            </div>
        </div>
    </header>

    <div class="main-container flex-col">
        <div class="flex flex-1 gap-4" style="height: 65%;">
            <div class="column w-1/3">
                <div class="card h-1/2"><h2 class="card-title text-red-500">ğŸ“¢ ê³µì§€ ì‚¬í•­</h2><div class="scroll-box"><div id="notice" class="scroll-content"></div></div></div>
                <div class="card h-1/2"><h2 class="card-title text-blue-500">ğŸ‘¥ ê·¼íƒœ í˜„í™©</h2><div class="scroll-box"><div id="attendance" class="scroll-content"></div></div></div>
            </div>
            <div class="column w-1/3">
                <div class="card h-full border-t-[6px] border-blue-500"><h2 class="card-title text-blue-600 italic">âœ… ì—…ë¬´ ê³µìœ </h2><div class="scroll-box" style="background-color: #eff6ff;"><div id="todoSheet" class="scroll-content"></div></div></div>
            </div>
            <div class="column w-1/3">
                <div class="card h-1/2"><h2 class="card-title text-green-500">ğŸ“¦ ê¸ˆì¼ ë‚©í’ˆ ëª©ë¡</h2><div class="scroll-box"><div id="delivery" class="scroll-content"></div></div></div>
                <div class="card h-1/2 border-t-[6px] border-red-500"><h2 class="card-title text-red-600">ğŸš¨ ê¸´ê¸‰ ì§„í–‰ ê±´</h2><div class="scroll-box" style="background-color: #fef2f2;"><div id="urgent" class="scroll-content"></div></div></div>
            </div>
        </div>
        <div class="flex gap-4" style="height: 35%;">
            <div class="card w-1/3"><h2 class="card-title text-purple-600">ğŸ“Š BBT</h2><div class="scroll-box"><div id="shareBBT" class="scroll-content"></div></div></div>
            <div class="card w-1/3"><h2 class="card-title text-orange-600">ğŸ”§ ì¸ì„œíŠ¸</h2><div class="scroll-box"><div id="shareInsert" class="scroll-content"></div></div></div>
            <div class="card w-1/3"><h2 class="card-title text-teal-600">âš ï¸ ë¦¬í„°ì¹˜</h2><div class="scroll-box"><div id="shareRetouch" class="scroll-content"></div></div></div>
        </div>
    </div>

    <script>
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTmOR1Hvcso4G0weHKCXvPpy9enUYo2mX0NIECrY7TDbjDfR_hf1fEBBUBM0qY1Pd8pL1HFFfqex88Z/pub?output=csv';

        const clean = (str) => {
            if (!str) return "";
            return str.replace(/^"|"$/g, '').trim().split('//').join('\n');
        };

        async function loadData() {
            try {
                const res = await fetch(`${SHEET_URL}&t=${Date.now()}`);
                const text = await res.text();
                const rows = text.split('\r\n');
                if (rows.length < 2) return;
                const data = rows[1].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);

                const v1 = parseInt(clean(data[0])) || 0;
                const v2 = parseInt(clean(data[1])) || 0;
                const v3 = parseInt(clean(data[2])) || 0;
                document.getElementById('otBBT').value = v1;
                document.getElementById('otInsert').value = v2;
                document.getElementById('otRetouch').value = v3;

                const boxes = [{v:v1, id:'box-otBBT'}, {v:v2, id:'box-otInsert'}, {v:v3, id:'box-otRetouch'}];
                const max = Math.max(v1, v2, v3);
                boxes.forEach(b => {
                    const el = document.getElementById(b.id);
                    el.classList.remove('max-highlight');
                    if(b.v === max && max > 0) el.classList.add('max-highlight');
                });

                document.getElementById('scrollingNotice').innerText = clean(data[3]).replace(/\n/g, " | ");
                document.getElementById('notice').innerText = clean(data[4]);
                document.getElementById('attendance').innerText = clean(data[5]);
                document.getElementById('delivery').innerText = clean(data[6]);
                document.getElementById('todoSheet').innerText = clean(data[7]);
                document.getElementById('urgent').innerText = clean(data[8]);
                document.getElementById('shareBBT').innerText = clean(data[9]);
                document.getElementById('shareInsert').innerText = clean(data[10]);
                document.getElementById('shareRetouch').innerText = clean(data[11]);

            } catch (e) { console.error("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨"); }
        }

        function checkTimeAlert() {
            const now = new Date();
            const time = now.getHours() * 100 + now.getMinutes(); // ì˜ˆ: 12:58 -> 1258
            const alertEl = document.getElementById('alertBanner');
            
            if (time >= 1258 && time <= 1303) {
                alertEl.style.display = 'block';
            } else {
                alertEl.style.display = 'none';
            }
        }

        function init() {
            setInterval(() => {
                const now = new Date();
                document.getElementById('clockDisplay').innerText = now.toLocaleString('ko-KR', { year: 'numeric', month: '2-digit', day: '2-digit', weekday: 'short', hour: '2-digit', minute: '2-digit', second: '2-digit' });
                checkTimeAlert();
            }, 1000);
            loadData();
            setInterval(loadData, 30000);
        }
        window.onload = init;
    </script>
</body>
</html>