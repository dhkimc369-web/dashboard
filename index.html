// 시트 데이터 로드 및 화면 반영 함수
async function loadSheetData() {
    const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTmOR1Hvcso4G0weHKCXvPpy9enUYo2mX0NIECrY7TDbjDfR_hf1fEBBUBM0qY1Pd8pL1HFFfqex88Z/pub?output=csv';
    
    try {
        const res = await fetch(SHEET_CSV_URL + "&t=" + Date.now());
        const csvText = await res.text();
        const rows = csvText.split('\n').map(row => row.split(','));

        if (rows[1]) {
            // 시트가 수기 입력보다 우선하도록 설정
            document.getElementById('notice').value = rows[1][0] || "";      // A열
            document.getElementById('attendance').value = rows[1][1] || "";  // B열
            document.getElementById('delivery').value = rows[1][2] || "";    // C열
            document.getElementById('share1').value = rows[1][3] || "";      // D열(인원)
            document.getElementById('share2').value = rows[1][4] || "";      // E열(설비)
            document.getElementById('share3').value = rows[1][5] || "";      // F열(품질)
            document.getElementById('share4').value = rows[1][6] || "";      // G열(기타)
            
            // 연장 인원 (D2, E2, F2 등으로 설정 가능 - 현재는 시트 기준)
            if(rows[1][7]) document.getElementById('otBBT').value = rows[1][7].trim();
            if(rows[1][8]) document.getElementById('otInsert').value = rows[1][8].trim();
            if(rows[1][9]) document.getElementById('otRetouch').value = rows[1][9].trim();
        }
    } catch (e) {
        console.error("시트 로드 실패:", e);
    }
}

// 날씨 정보 (천안 기준)
async function getWeather() {
    try {
        const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=Cheonan&appid=895284fb2d2c1d87c4676455964815b9&units=metric&lang=kr`);
        const data = await res.json();
        document.getElementById('temp').innerText = Math.round(data.main.temp);
        document.getElementById('desc').innerText = data.weather[0].description + " (천안)";
    } catch (e) {
        document.getElementById('desc').innerText = "날씨 정보 로드 실패";
    }
}